"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upload-music";
exports.ids = ["pages/api/upload-music"];
exports.modules = {

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload-music&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fupload-music.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload-music&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fupload-music.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/upload-music.ts */ \"(api)/./pages/api/upload-music.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/upload-music\",\n        pathname: \"/api/upload-music\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_upload_music_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwbG9hZC1tdXNpYyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGdXBsb2FkLW11c2ljLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3RvcnktbXVzaWMtZGFwcC8/YmZiOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL3VwbG9hZC1tdXNpYy50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3VwbG9hZC1tdXNpY1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3VwbG9hZC1tdXNpY1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload-music&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fupload-music.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/upload-music.ts":
/*!***********************************!*\
  !*** ./pages/api/upload-music.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   getMusicStorage: () => (/* binding */ getMusicStorage)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/functions/uploadToIpfs */ \"(api)/./utils/functions/uploadToIpfs.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_0__, _utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__]);\n([formidable__WEBPACK_IMPORTED_MODULE_0__, _utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n// Persistent file storage\nconst STORAGE_FILE = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"music-storage.json\");\nfunction loadMusicStorage() {\n    try {\n        if (fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(STORAGE_FILE)) {\n            const data = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(STORAGE_FILE, \"utf8\");\n            return JSON.parse(data);\n        }\n    } catch (error) {\n        console.error(\"Error loading music storage:\", error);\n    }\n    return [];\n}\nfunction saveMusicStorage(music) {\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1___default().writeFileSync(STORAGE_FILE, JSON.stringify(music, null, 2));\n    } catch (error) {\n        console.error(\"Error saving music storage:\", error);\n    }\n}\nfunction getMusicStorage() {\n    return loadMusicStorage();\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            uploadDir: \"/tmp\",\n            keepExtensions: true,\n            maxFileSize: 100 * 1024 * 1024\n        });\n        const [fields, files] = await form.parse(req);\n        const title = Array.isArray(fields.title) ? fields.title[0] : fields.title;\n        const artist = Array.isArray(fields.artist) ? fields.artist[0] : fields.artist;\n        const description = Array.isArray(fields.description) ? fields.description[0] : fields.description;\n        const price = Array.isArray(fields.price) ? fields.price[0] : fields.price;\n        const owner = Array.isArray(fields.owner) ? fields.owner[0] : fields.owner;\n        const audioFile = Array.isArray(files.audioFile) ? files.audioFile[0] : files.audioFile;\n        const imageFile = Array.isArray(files.imageFile) ? files.imageFile[0] : files.imageFile;\n        if (!audioFile || !title || !artist || !owner) {\n            return res.status(400).json({\n                error: \"Missing required fields\"\n            });\n        }\n        // Upload files to IPFS\n        let audioUrl = \"\";\n        let imageUrl = \"\";\n        try {\n            const audioBuffer = await fs__WEBPACK_IMPORTED_MODULE_1___default().promises.readFile(audioFile.filepath);\n            audioUrl = await (0,_utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__.uploadFileToIPFS)(audioBuffer);\n            console.log(\"Audio uploaded to IPFS:\", audioUrl);\n            if (imageFile) {\n                const imageBuffer = await fs__WEBPACK_IMPORTED_MODULE_1___default().promises.readFile(imageFile.filepath);\n                imageUrl = await (0,_utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__.uploadFileToIPFS)(imageBuffer);\n                console.log(\"Image uploaded to IPFS:\", imageUrl);\n            }\n        } catch (ipfsError) {\n            console.error(\"IPFS upload error:\", ipfsError);\n            // Continue without IPFS for now\n            audioUrl = \"placeholder-audio-url\";\n            imageUrl = \"placeholder-image-url\";\n        }\n        // Create metadata for NFT\n        const metadata = {\n            name: title,\n            description: description || `${title} by ${artist}`,\n            image: imageUrl,\n            audio: audioUrl,\n            attributes: [\n                {\n                    trait_type: \"Artist\",\n                    value: artist\n                },\n                {\n                    trait_type: \"Title\",\n                    value: title\n                },\n                {\n                    trait_type: \"License Price\",\n                    value: price || \"0\"\n                }\n            ]\n        };\n        let metadataUrl = \"\";\n        try {\n            metadataUrl = await (0,_utils_functions_uploadToIpfs__WEBPACK_IMPORTED_MODULE_3__.uploadJSONToIPFS)(metadata);\n            console.log(\"Metadata uploaded to IPFS:\", metadataUrl);\n        } catch (metadataError) {\n            console.error(\"Metadata upload error:\", metadataError);\n            metadataUrl = \"placeholder-metadata-url\";\n        }\n        // Create unique ID for the music NFT\n        const musicId = (0,crypto__WEBPACK_IMPORTED_MODULE_4__.createHash)(\"sha256\").update(`${title}-${artist}-${Date.now()}`).digest(\"hex\").slice(0, 16);\n        // Create music NFT object\n        const musicNFT = {\n            id: musicId,\n            title: title,\n            artist: artist,\n            description: description || \"\",\n            price: price || \"0\",\n            audioUrl: audioUrl,\n            imageUrl: imageUrl,\n            owner: owner,\n            metadataUrl: metadataUrl,\n            createdAt: new Date().toISOString()\n        };\n        // Store the NFT data persistently\n        const currentMusic = loadMusicStorage();\n        currentMusic.push(musicNFT);\n        saveMusicStorage(currentMusic);\n        console.log(\"Music NFT stored:\", musicNFT);\n        // Clean up temporary files\n        try {\n            if (audioFile.filepath) await fs__WEBPACK_IMPORTED_MODULE_1___default().promises.unlink(audioFile.filepath);\n            if (imageFile?.filepath) await fs__WEBPACK_IMPORTED_MODULE_1___default().promises.unlink(imageFile.filepath);\n        } catch (cleanupError) {\n            console.error(\"Cleanup error:\", cleanupError);\n        }\n        res.status(200).json({\n            success: true,\n            musicNFT: musicNFT,\n            message: \"Music NFT uploaded successfully\"\n        });\n    } catch (error) {\n        console.error(\"Upload error:\", error);\n        res.status(500).json({\n            error: \"Failed to upload music NFT\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlQO1lBQ0ozQixPQUFPQTtZQUNQRyxRQUFRQTtZQUNSQyxhQUFhQSxlQUFlO1lBQzVCQyxPQUFPQSxTQUFTO1lBQ2hCSSxVQUFVQTtZQUNWQyxVQUFVQTtZQUNWSixPQUFPQTtZQUNQbUIsYUFBYUE7WUFDYlUsV0FBVyxJQUFJTixPQUFPTyxXQUFXO1FBQ25DO1FBRUEsa0NBQWtDO1FBQ2xDLE1BQU1DLGVBQWU5RDtRQUNyQjhELGFBQWFDLElBQUksQ0FBQ0w7UUFDbEJsRCxpQkFBaUJzRDtRQUNqQnZELFFBQVFpQyxHQUFHLENBQUMscUJBQXFCa0I7UUFFakMsMkJBQTJCO1FBQzNCLElBQUk7WUFDRixJQUFJMUIsVUFBVU8sUUFBUSxFQUFFLE1BQU1uRCxrREFBVyxDQUFDNEUsTUFBTSxDQUFDaEMsVUFBVU8sUUFBUTtZQUNuRSxJQUFJTixXQUFXTSxVQUFVLE1BQU1uRCxrREFBVyxDQUFDNEUsTUFBTSxDQUFDL0IsVUFBVU0sUUFBUTtRQUN0RSxFQUFFLE9BQU8wQixjQUFjO1lBQ3JCMUQsUUFBUUQsS0FBSyxDQUFDLGtCQUFrQjJEO1FBQ2xDO1FBRUFsRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CZ0QsU0FBUztZQUNUUixVQUFVQTtZQUNWUyxTQUFTO1FBQ1g7SUFFRixFQUFFLE9BQU83RCxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxpQkFBaUJBO1FBQy9CUyxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CWixPQUFPO1lBQ1A4RCxTQUFTOUQsaUJBQWlCK0QsUUFBUS9ELE1BQU02RCxPQUFPLEdBQUc7UUFDcEQ7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3RvcnktbXVzaWMtZGFwcC8uL3BhZ2VzL2FwaS91cGxvYWQtbXVzaWMudHM/MGY5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCdcbmltcG9ydCBmb3JtaWRhYmxlIGZyb20gJ2Zvcm1pZGFibGUnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IHsgdXBsb2FkRmlsZVRvSVBGUywgdXBsb2FkSlNPTlRvSVBGUyB9IGZyb20gJy4uLy4uL3V0aWxzL2Z1bmN0aW9ucy91cGxvYWRUb0lwZnMnXG5pbXBvcnQgeyBjbGllbnQgfSBmcm9tICcuLi8uLi91dGlscy9jb25maWcnXG5pbXBvcnQgeyBjcmVhdGVDb21tZXJjaWFsUmVtaXhUZXJtcywgU1BHTkZUQ29udHJhY3RBZGRyZXNzIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnXG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnY3J5cHRvJ1xuaW1wb3J0IHsgSXBNZXRhZGF0YSB9IGZyb20gJ0BzdG9yeS1wcm90b2NvbC9jb3JlLXNkaydcbmltcG9ydCB7IEFkZHJlc3MgfSBmcm9tICd2aWVtJ1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBhcGk6IHtcbiAgICBib2R5UGFyc2VyOiBmYWxzZSxcbiAgfSxcbn1cblxuLy8gUGVyc2lzdGVudCBmaWxlIHN0b3JhZ2VcbmNvbnN0IFNUT1JBR0VfRklMRSA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnbXVzaWMtc3RvcmFnZS5qc29uJylcblxuZnVuY3Rpb24gbG9hZE11c2ljU3RvcmFnZSgpOiBhbnlbXSB7XG4gIHRyeSB7XG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoU1RPUkFHRV9GSUxFKSkge1xuICAgICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhTVE9SQUdFX0ZJTEUsICd1dGY4JylcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgbXVzaWMgc3RvcmFnZTonLCBlcnJvcilcbiAgfVxuICByZXR1cm4gW11cbn1cblxuZnVuY3Rpb24gc2F2ZU11c2ljU3RvcmFnZShtdXNpYzogYW55W10pOiB2b2lkIHtcbiAgdHJ5IHtcbiAgICBmcy53cml0ZUZpbGVTeW5jKFNUT1JBR0VfRklMRSwgSlNPTi5zdHJpbmdpZnkobXVzaWMsIG51bGwsIDIpKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBtdXNpYyBzdG9yYWdlOicsIGVycm9yKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNdXNpY1N0b3JhZ2UoKTogYW55W10ge1xuICByZXR1cm4gbG9hZE11c2ljU3RvcmFnZSgpXG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBmb3JtID0gZm9ybWlkYWJsZSh7XG4gICAgICB1cGxvYWREaXI6ICcvdG1wJyxcbiAgICAgIGtlZXBFeHRlbnNpb25zOiB0cnVlLFxuICAgICAgbWF4RmlsZVNpemU6IDEwMCAqIDEwMjQgKiAxMDI0LCAvLyAxMDBNQlxuICAgIH0pXG5cbiAgICBjb25zdCBbZmllbGRzLCBmaWxlc10gPSBhd2FpdCBmb3JtLnBhcnNlKHJlcSlcblxuICAgIGNvbnN0IHRpdGxlID0gQXJyYXkuaXNBcnJheShmaWVsZHMudGl0bGUpID8gZmllbGRzLnRpdGxlWzBdIDogZmllbGRzLnRpdGxlXG4gICAgY29uc3QgYXJ0aXN0ID0gQXJyYXkuaXNBcnJheShmaWVsZHMuYXJ0aXN0KSA/IGZpZWxkcy5hcnRpc3RbMF0gOiBmaWVsZHMuYXJ0aXN0XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBBcnJheS5pc0FycmF5KGZpZWxkcy5kZXNjcmlwdGlvbikgPyBmaWVsZHMuZGVzY3JpcHRpb25bMF0gOiBmaWVsZHMuZGVzY3JpcHRpb25cbiAgICBjb25zdCBwcmljZSA9IEFycmF5LmlzQXJyYXkoZmllbGRzLnByaWNlKSA/IGZpZWxkcy5wcmljZVswXSA6IGZpZWxkcy5wcmljZVxuICAgIGNvbnN0IG93bmVyID0gQXJyYXkuaXNBcnJheShmaWVsZHMub3duZXIpID8gZmllbGRzLm93bmVyWzBdIDogZmllbGRzLm93bmVyXG5cbiAgICBjb25zdCBhdWRpb0ZpbGUgPSBBcnJheS5pc0FycmF5KGZpbGVzLmF1ZGlvRmlsZSkgPyBmaWxlcy5hdWRpb0ZpbGVbMF0gOiBmaWxlcy5hdWRpb0ZpbGVcbiAgICBjb25zdCBpbWFnZUZpbGUgPSBBcnJheS5pc0FycmF5KGZpbGVzLmltYWdlRmlsZSkgPyBmaWxlcy5pbWFnZUZpbGVbMF0gOiBmaWxlcy5pbWFnZUZpbGVcblxuICAgIGlmICghYXVkaW9GaWxlIHx8ICF0aXRsZSB8fCAhYXJ0aXN0IHx8ICFvd25lcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycgfSlcbiAgICB9XG5cbiAgICAvLyBVcGxvYWQgZmlsZXMgdG8gSVBGU1xuICAgIGxldCBhdWRpb1VybCA9ICcnXG4gICAgbGV0IGltYWdlVXJsID0gJydcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBhdWRpb0J1ZmZlciA9IGF3YWl0IGZzLnByb21pc2VzLnJlYWRGaWxlKGF1ZGlvRmlsZS5maWxlcGF0aClcbiAgICAgIGF1ZGlvVXJsID0gYXdhaXQgdXBsb2FkRmlsZVRvSVBGUyhhdWRpb0J1ZmZlcilcbiAgICAgIGNvbnNvbGUubG9nKCdBdWRpbyB1cGxvYWRlZCB0byBJUEZTOicsIGF1ZGlvVXJsKVxuXG4gICAgICBpZiAoaW1hZ2VGaWxlKSB7XG4gICAgICAgIGNvbnN0IGltYWdlQnVmZmVyID0gYXdhaXQgZnMucHJvbWlzZXMucmVhZEZpbGUoaW1hZ2VGaWxlLmZpbGVwYXRoKVxuICAgICAgICBpbWFnZVVybCA9IGF3YWl0IHVwbG9hZEZpbGVUb0lQRlMoaW1hZ2VCdWZmZXIpXG4gICAgICAgIGNvbnNvbGUubG9nKCdJbWFnZSB1cGxvYWRlZCB0byBJUEZTOicsIGltYWdlVXJsKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGlwZnNFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignSVBGUyB1cGxvYWQgZXJyb3I6JywgaXBmc0Vycm9yKVxuICAgICAgLy8gQ29udGludWUgd2l0aG91dCBJUEZTIGZvciBub3dcbiAgICAgIGF1ZGlvVXJsID0gJ3BsYWNlaG9sZGVyLWF1ZGlvLXVybCdcbiAgICAgIGltYWdlVXJsID0gJ3BsYWNlaG9sZGVyLWltYWdlLXVybCdcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgbWV0YWRhdGEgZm9yIE5GVFxuICAgIGNvbnN0IG1ldGFkYXRhID0ge1xuICAgICAgbmFtZTogdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgYCR7dGl0bGV9IGJ5ICR7YXJ0aXN0fWAsXG4gICAgICBpbWFnZTogaW1hZ2VVcmwsXG4gICAgICBhdWRpbzogYXVkaW9VcmwsXG4gICAgICBhdHRyaWJ1dGVzOiBbXG4gICAgICAgIHsgdHJhaXRfdHlwZTogJ0FydGlzdCcsIHZhbHVlOiBhcnRpc3QgfSxcbiAgICAgICAgeyB0cmFpdF90eXBlOiAnVGl0bGUnLCB2YWx1ZTogdGl0bGUgfSxcbiAgICAgICAgeyB0cmFpdF90eXBlOiAnTGljZW5zZSBQcmljZScsIHZhbHVlOiBwcmljZSB8fCAnMCcgfVxuICAgICAgXVxuICAgIH1cblxuICAgIGxldCBtZXRhZGF0YVVybCA9ICcnXG4gICAgdHJ5IHtcbiAgICAgIG1ldGFkYXRhVXJsID0gYXdhaXQgdXBsb2FkSlNPTlRvSVBGUyhtZXRhZGF0YSlcbiAgICAgIGNvbnNvbGUubG9nKCdNZXRhZGF0YSB1cGxvYWRlZCB0byBJUEZTOicsIG1ldGFkYXRhVXJsKVxuICAgIH0gY2F0Y2ggKG1ldGFkYXRhRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ01ldGFkYXRhIHVwbG9hZCBlcnJvcjonLCBtZXRhZGF0YUVycm9yKVxuICAgICAgbWV0YWRhdGFVcmwgPSAncGxhY2Vob2xkZXItbWV0YWRhdGEtdXJsJ1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB1bmlxdWUgSUQgZm9yIHRoZSBtdXNpYyBORlRcbiAgICBjb25zdCBtdXNpY0lkID0gY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKGAke3RpdGxlfS0ke2FydGlzdH0tJHtEYXRlLm5vdygpfWApLmRpZ2VzdCgnaGV4Jykuc2xpY2UoMCwgMTYpXG5cbiAgICAvLyBDcmVhdGUgbXVzaWMgTkZUIG9iamVjdFxuICAgIGNvbnN0IG11c2ljTkZUID0ge1xuICAgICAgaWQ6IG11c2ljSWQsXG4gICAgICB0aXRsZTogdGl0bGUsXG4gICAgICBhcnRpc3Q6IGFydGlzdCxcbiAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgIHByaWNlOiBwcmljZSB8fCAnMCcsXG4gICAgICBhdWRpb1VybDogYXVkaW9VcmwsXG4gICAgICBpbWFnZVVybDogaW1hZ2VVcmwsXG4gICAgICBvd25lcjogb3duZXIsXG4gICAgICBtZXRhZGF0YVVybDogbWV0YWRhdGFVcmwsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH1cblxuICAgIC8vIFN0b3JlIHRoZSBORlQgZGF0YSBwZXJzaXN0ZW50bHlcbiAgICBjb25zdCBjdXJyZW50TXVzaWMgPSBsb2FkTXVzaWNTdG9yYWdlKClcbiAgICBjdXJyZW50TXVzaWMucHVzaChtdXNpY05GVClcbiAgICBzYXZlTXVzaWNTdG9yYWdlKGN1cnJlbnRNdXNpYylcbiAgICBjb25zb2xlLmxvZygnTXVzaWMgTkZUIHN0b3JlZDonLCBtdXNpY05GVClcblxuICAgIC8vIENsZWFuIHVwIHRlbXBvcmFyeSBmaWxlc1xuICAgIHRyeSB7XG4gICAgICBpZiAoYXVkaW9GaWxlLmZpbGVwYXRoKSBhd2FpdCBmcy5wcm9taXNlcy51bmxpbmsoYXVkaW9GaWxlLmZpbGVwYXRoKVxuICAgICAgaWYgKGltYWdlRmlsZT8uZmlsZXBhdGgpIGF3YWl0IGZzLnByb21pc2VzLnVubGluayhpbWFnZUZpbGUuZmlsZXBhdGgpXG4gICAgfSBjYXRjaCAoY2xlYW51cEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdDbGVhbnVwIGVycm9yOicsIGNsZWFudXBFcnJvcilcbiAgICB9XG5cbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbXVzaWNORlQ6IG11c2ljTkZULFxuICAgICAgbWVzc2FnZTogJ011c2ljIE5GVCB1cGxvYWRlZCBzdWNjZXNzZnVsbHknXG4gICAgfSlcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1VwbG9hZCBlcnJvcjonLCBlcnJvcilcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gdXBsb2FkIG11c2ljIE5GVCcsXG4gICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH0pXG4gIH1cbn0iXSwibmFtZXMiOlsiZm9ybWlkYWJsZSIsImZzIiwicGF0aCIsInVwbG9hZEZpbGVUb0lQRlMiLCJ1cGxvYWRKU09OVG9JUEZTIiwiY3JlYXRlSGFzaCIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJTVE9SQUdFX0ZJTEUiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImxvYWRNdXNpY1N0b3JhZ2UiLCJleGlzdHNTeW5jIiwiZGF0YSIsInJlYWRGaWxlU3luYyIsIkpTT04iLCJwYXJzZSIsImVycm9yIiwiY29uc29sZSIsInNhdmVNdXNpY1N0b3JhZ2UiLCJtdXNpYyIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJnZXRNdXNpY1N0b3JhZ2UiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImZvcm0iLCJ1cGxvYWREaXIiLCJrZWVwRXh0ZW5zaW9ucyIsIm1heEZpbGVTaXplIiwiZmllbGRzIiwiZmlsZXMiLCJ0aXRsZSIsIkFycmF5IiwiaXNBcnJheSIsImFydGlzdCIsImRlc2NyaXB0aW9uIiwicHJpY2UiLCJvd25lciIsImF1ZGlvRmlsZSIsImltYWdlRmlsZSIsImF1ZGlvVXJsIiwiaW1hZ2VVcmwiLCJhdWRpb0J1ZmZlciIsInByb21pc2VzIiwicmVhZEZpbGUiLCJmaWxlcGF0aCIsImxvZyIsImltYWdlQnVmZmVyIiwiaXBmc0Vycm9yIiwibWV0YWRhdGEiLCJuYW1lIiwiaW1hZ2UiLCJhdWRpbyIsImF0dHJpYnV0ZXMiLCJ0cmFpdF90eXBlIiwidmFsdWUiLCJtZXRhZGF0YVVybCIsIm1ldGFkYXRhRXJyb3IiLCJtdXNpY0lkIiwidXBkYXRlIiwiRGF0ZSIsIm5vdyIsImRpZ2VzdCIsInNsaWNlIiwibXVzaWNORlQiLCJpZCIsImNyZWF0ZWRBdCIsInRvSVNPU3RyaW5nIiwiY3VycmVudE11c2ljIiwicHVzaCIsInVubGluayIsImNsZWFudXBFcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZGV0YWlscyIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/upload-music.ts\n");

/***/ }),

/***/ "(api)/./utils/functions/uploadToIpfs.ts":
/*!*****************************************!*\
  !*** ./utils/functions/uploadToIpfs.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   uploadFileToIPFS: () => (/* binding */ uploadFileToIPFS),\n/* harmony export */   uploadJSONToIPFS: () => (/* binding */ uploadJSONToIPFS)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dotenv */ \"dotenv\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_1__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\ndotenv__WEBPACK_IMPORTED_MODULE_1___default().config();\nconst JWT = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiI1NzgyNjg5NS0zZWI5LTQ0YTEtOTVlNS0xZjk0ZDA0ODg3YjEiLCJlbWFpbCI6ImFzODk2MjcwMzUyMEBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicGluX3BvbGljeSI6eyJyZWdpb25zIjpbeyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJGUkExIn0seyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJOWUMxIn1dLCJ2ZXJzaW9uIjoxfSwibWZhX2VuYWJsZWQiOmZhbHNlLCJzdGF0dXMiOiJBQ1RJVkUifSwiYXV0aGVudGljYXRpb25UeXBlIjoic2NvcGVkS2V5Iiwic2NvcGVkS2V5S2V5IjoiMTE0YTQyMGI2ZmUyY2FlNDlmZTMiLCJzY29wZWRLZXlTZWNyZXQiOiIyODQ4MDViZmM1NjM5YmYyMmQwMzJlMTFkMzc2NTQyMzg3MzZhZWRkYmE2YTFmMWI4MWMwYjg2MWYzZTU4Y2ExIiwiZXhwIjoxNzgwODExMDUzfQ.dbvr2VgOxhVhXOhZ39VLkEhJsZvH8Ge_yy85lWrfWTY\";\nasync function uploadFileToIPFS(fileBuffer) {\n    try {\n        const formData = new FormData();\n        const blob = new Blob([\n            fileBuffer\n        ]);\n        formData.append(\"file\", blob);\n        const pinataMetadata = JSON.stringify({\n            name: `file-${Date.now()}`\n        });\n        formData.append(\"pinataMetadata\", pinataMetadata);\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(\"https://api.pinata.cloud/pinning/pinFileToIPFS\", formData, {\n            headers: {\n                \"Content-Type\": \"multipart/form-data\",\n                Authorization: `Bearer ${JWT}`\n            }\n        });\n        return response.data.IpfsHash;\n    } catch (error) {\n        console.error(\"Error uploading file to IPFS:\", error);\n        throw error;\n    }\n}\nasync function uploadJSONToIPFS(jsonData) {\n    try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(\"https://api.pinata.cloud/pinning/pinJSONToIPFS\", jsonData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: `Bearer ${JWT}`\n            }\n        });\n        return response.data.IpfsHash;\n    } catch (error) {\n        console.error(\"Error uploading JSON to IPFS:\", error);\n        throw error;\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy9mdW5jdGlvbnMvdXBsb2FkVG9JcGZzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ3lCO0FBQ0U7QUFFM0JDLG9EQUFhO0FBRWIsTUFBTUUsTUFBTUMsaXJCQUFzQjtBQUUzQixlQUFlRyxpQkFBaUJDLFVBQWtCO0lBQ3JELElBQUk7UUFDQSxNQUFNQyxXQUFXLElBQUlDO1FBQ3JCLE1BQU1DLE9BQU8sSUFBSUMsS0FBSztZQUFDSjtTQUFXO1FBQ2xDQyxTQUFTSSxNQUFNLENBQUMsUUFBUUY7UUFFeEIsTUFBTUcsaUJBQWlCQyxLQUFLQyxTQUFTLENBQUM7WUFDbENDLE1BQU0sQ0FBQyxLQUFLLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDO1FBQzlCO1FBQ0FWLFNBQVNJLE1BQU0sQ0FBQyxrQkFBa0JDO1FBRWxDLE1BQU1NLFdBQVcsTUFBTXBCLGtEQUFVLENBQUMsa0RBQWtEUyxVQUFVO1lBQzFGYSxTQUFTO2dCQUNMLGdCQUFnQjtnQkFDaEJDLGVBQWUsQ0FBQyxPQUFPLEVBQUVwQixJQUFJLENBQUM7WUFDbEM7UUFDSjtRQUVBLE9BQU9pQixTQUFTSSxJQUFJLENBQUNDLFFBQVE7SUFDakMsRUFBRSxPQUFPQyxPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE1BQU1BO0lBQ1Y7QUFDSjtBQUVPLGVBQWVFLGlCQUFpQkMsUUFBYTtJQUNoRCxJQUFJO1FBQ0EsTUFBTVQsV0FBVyxNQUFNcEIsa0RBQVUsQ0FDN0Isa0RBQ0E2QixVQUNBO1lBQ0lQLFNBQVM7Z0JBQ0wsZ0JBQWdCO2dCQUNoQkMsZUFBZSxDQUFDLE9BQU8sRUFBRXBCLElBQUksQ0FBQztZQUNsQztRQUNKO1FBR0osT0FBT2lCLFNBQVNJLElBQUksQ0FBQ0MsUUFBUTtJQUNqQyxFQUFFLE9BQU9DLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsTUFBTUE7SUFDVjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3RvcnktbXVzaWMtZGFwcC8uL3V0aWxzL2Z1bmN0aW9ucy91cGxvYWRUb0lwZnMudHM/YzljNCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcydcbmltcG9ydCBkb3RlbnYgZnJvbSAnZG90ZW52J1xuXG5kb3RlbnYuY29uZmlnKClcblxuY29uc3QgSldUID0gcHJvY2Vzcy5lbnYuUElOQVRBX0pXVFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBsb2FkRmlsZVRvSVBGUyhmaWxlQnVmZmVyOiBCdWZmZXIpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKClcbiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtmaWxlQnVmZmVyXSlcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgYmxvYilcblxuICAgICAgICBjb25zdCBwaW5hdGFNZXRhZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIG5hbWU6IGBmaWxlLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICB9KVxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3BpbmF0YU1ldGFkYXRhJywgcGluYXRhTWV0YWRhdGEpXG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KCdodHRwczovL2FwaS5waW5hdGEuY2xvdWQvcGlubmluZy9waW5GaWxlVG9JUEZTJywgZm9ybURhdGEsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnLFxuICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtKV1R9YCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuSXBmc0hhc2hcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGxvYWRpbmcgZmlsZSB0byBJUEZTOicsIGVycm9yKVxuICAgICAgICB0aHJvdyBlcnJvclxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZEpTT05Ub0lQRlMoanNvbkRhdGE6IGFueSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KFxuICAgICAgICAgICAgJ2h0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC9waW5uaW5nL3BpbkpTT05Ub0lQRlMnLFxuICAgICAgICAgICAganNvbkRhdGEsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7SldUfWAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuXG4gICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLklwZnNIYXNoXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBsb2FkaW5nIEpTT04gdG8gSVBGUzonLCBlcnJvcilcbiAgICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiYXhpb3MiLCJkb3RlbnYiLCJjb25maWciLCJKV1QiLCJwcm9jZXNzIiwiZW52IiwiUElOQVRBX0pXVCIsInVwbG9hZEZpbGVUb0lQRlMiLCJmaWxlQnVmZmVyIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImJsb2IiLCJCbG9iIiwiYXBwZW5kIiwicGluYXRhTWV0YWRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsIkRhdGUiLCJub3ciLCJyZXNwb25zZSIsInBvc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImRhdGEiLCJJcGZzSGFzaCIsImVycm9yIiwiY29uc29sZSIsInVwbG9hZEpTT05Ub0lQRlMiLCJqc29uRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./utils/functions/uploadToIpfs.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload-music&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fupload-music.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();